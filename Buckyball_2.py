import numpy as np;
import torch

class buckyball_2():
    
    def __init__(self, beta=1):
        self.beta=beta;
        
    def connect(self):
        connect1 = np.array([[1, 2, 12, 3],
                             [2, 1, 4, 6],
                             [3, 11, 1, 35],
                             [4, 33, 2, 5],
                             [5, 38, 8, 4],
                             [6, 7, 2, 13],
                             [7, 8, 6, 54],
                             [8, 7, 59, 5],
                             [9, 10, 11, 20],
                             [10, 9, 14, 12],
                             [11, 19, 3, 9],
                             [12, 13, 10, 1],
                             [13, 12, 16, 6],
                             [14, 10, 15, 21],
                             [15, 50, 14, 16],
                             [16, 55, 13, 15],
                             [17, 28, 19, 18],
                             [18, 22, 20, 17],
                             [19, 11, 27, 17],
                             [20, 21, 9, 18],
                             [21, 20, 24, 14],
                             [22, 18, 29, 23],
                             [23, 46, 24, 22],
                             [24, 51, 21, 23],
                             [25, 36, 27, 26],
                             [26, 30, 28, 25],
                             [27, 19, 35, 25],
                             [28, 17, 29, 26],
                             [29, 28, 22, 32],
                             [30, 26, 31, 37],
                             [31, 42, 30, 32],
                             [32, 47, 29, 31],
                             [33, 4, 35, 34],
                             [34, 38, 33, 36],
                             [35, 27, 33, 3],
                             [36, 37, 25, 34],
                             [37, 36, 40, 30],
                             [38, 34, 5, 39],
                             [39, 58, 38, 40],
                             [40, 43, 37, 39],
                             [41, 47, 42, 44],
                             [42, 31, 43, 41],
                             [43, 40, 57, 42],
                             [44, 60, 48, 41],
                             [45, 46, 51, 48],
                             [46, 47, 45, 23],
                             [47, 46, 41, 32],
                             [48, 52, 45, 44],
                             [49, 55, 52, 50],
                             [50, 51, 15, 49],
                             [51, 50, 24, 45],
                             [52, 48, 56, 49],
                             [53, 54, 56, 59],
                             [54, 55, 53, 7],
                             [55, 54, 16, 49],
                             [56, 52, 60, 53],
                             [57, 60, 43, 58],
                             [58, 59, 39, 57],
                             [59, 8, 58, 53],
                             [60, 57, 56, 44]])

        connect1 = np.delete(connect1,0,axis=1)
        return connect1
        

    def energy(self,sample):
        
        connect = self.connect();
        eng = sample[:,:]*(sample[:,connect[:,0]-1]+sample[:,connect[:,1]-1]+sample[:,connect[:,2]-1])
        return torch.sum(eng,1)/2